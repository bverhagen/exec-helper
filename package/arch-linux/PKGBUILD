# Maintainer: bverhagen <barrie.verhagen@gmail.com>
pkgname=exec-helper
pkgver=0.0.1
pkgrel=1
pkgdesc="Tool to enable a more efficient development workflow"
arch=('any')
url="https://github.com/bverhagen/exec-helper"
license=('APACHE')
groups=()
depends=('python')
makedepends=('git')
checkdepends=('python3')
optdepends=('clang: for static analysis',
            'cppcheck: for static analysis',
            'simian: for static analysis',
            'cpplint: for static analysis',
            'valgrind: for dynamic analysis and profiling information',
            'perf: for profiling information',
           )
provides=()
conflicts=()
replaces=()
backup=()
options=()
install=
changelog=
source=('git+https://github.com/bverhagen/exec-helper.git')
noextract=()
md5sums=('SKIP')

package() {
  pushd "$pkgname"
  install -D "exec.py" "$pkgdir/usr/lib/$pkgname/exec.py"
  install -Dd "exec_utils" "$pkgdir/usr/lib/$pkgname/exec_utils"

  # Create directory structure
  find exec_utils -type d -exec install -Dd "{}" "$pkgdir/usr/lib/$pkgname/{}" \;

  # Copy all files
  find exec_utils -type f -exec install -D "{}" "$pkgdir/usr/lib/$pkgname/{}" \;

  # Create symlink in /usr/bin
  install -Dd "/usr/bin" "$pkgdir/usr/bin"
  install -D "package/exec-helper" "$pkgdir/usr/bin/exec-helper"
  popd
}

check() {
    pushd "$pkgname"
    python3 "test/distcleanTargetTest.py"
    python3 "test/buildTargetTest.py"
    python3 "test/runTargetTest.py"
    popd
}
