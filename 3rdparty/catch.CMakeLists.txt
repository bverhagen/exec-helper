option(USE_SYSTEM_CATCH "Use the catch library provided by the system" ON)

if(${USE_SYSTEM_CATCH})
    find_package(Catch REQUIRED)
else(${USE_SYSTEM_CATCH})
    include(ExternalProject)

    set(CATCH_INSTALL_DIR ${LIB_DIRECTORY}/catch)

    ExternalProject_Add(Catch
        PREFIX catch
        GIT_REPOSITORY https://github.com/philsquared/Catch.git
        CONFIGURE_COMMAND ""
        BUILD_COMMAND ""
        INSTALL_COMMAND ""
        UPDATE_COMMAND ""
        )

    set(Catch_INCLUDE_DIRS ${CMAKE_CURRENT_BINARY_DIR}/catch/src/Catch/single_include)
endif(${USE_SYSTEM_CATCH})

add_library(catch INTERFACE)
target_include_directories(catch SYSTEM INTERFACE ${Catch_INCLUDE_DIRS})

if(NOT ${USE_SYSTEM_CATCH})
    add_dependencies(catch Catch)
endif()
